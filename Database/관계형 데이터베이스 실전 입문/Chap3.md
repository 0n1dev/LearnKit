# 정규화 논리(첫 번째) - 함수 종속성
## DB 설계의 중요성

> 쿼리는 DB에 포함된 각 테이블이 적절히 설계되어 있지 않으면 깔끔하게 표현이 불가능하다.

- RDB를 사용하는 데 있어서 **정규화**는 중요

## 정규화

> 관계형 모델을 보완하는 이론

- 릴레이션이 정규화 되어 있지 않아도 동일하게 처리 가능
- 릴레이션의 연산을 적용할 수 있다는 말이지 정규화 되어 있지 않은 릴레이션을 취급하기 쉽다는 말은 아님

### 장점

- 변칙을 방지할 수 있다.
    - 데이터가 논리적인 불일치가 일어나는 상태를 **모순이 발생한 상태** 즉 **변칙**이라고 함
    - 변칙을 일으키는 원인은 **중복**이다. 
        - 릴레이션에 같은 데이터가 여러 개 존재하는 것을 말함
        - 모순이 생기지 않게 하려면 중복을 제거하면 됨

-> 중복을 제거하는 작업을 시행하는 데 도움이 되는 것이 **정규화**

## 정규형 (Normal Form, NF)

> 졍규화에는 몇 가지 단계가 있고 높은 단계로 갈수록 더 좋은 상태가 됨. 이러한 단계를 **정규형**이라고 함

### 종류

- 제1 정규형(1NF)
- 제2 정규형(2NF)
- 제3 정규형(3NF)
- 보이스코드 정규형(BCNF)
- 제4 정규형(4NF)
- 제5 정규형(5NF)
- 제6 정규형(6NF)

-> 높은 단계의 정규형은 자동으로 그 이전 정규화를 만족함
 
### 제1 정규형

> 릴레이션이어야 할 것

- 행이 위에서 아래로 정령되어 있지 않다.
- 열이 왼쪽에서 오른쪽으로 정렬되어 있지 않다.

->  
- 쿼리문을 작성시 테이블의 컬럼이나 행에 순서에 의존하지 않도록 작성
- 컬럼 순서에 의존하는 처리 예시
    - SELECT *을 사용해서 모든 컬럼의 값을 조회 후 컬럼 위치에 따라 데이터 접근
    - ORDER BY 에 인수로 select list 내에서 컬럼  위치를 지정하는 것 (ORDER BY 1)
---
- 중복하는 행이 존재하지 않는다.

-> 동일 행에서 값이 최대 1개이상 포함되지 않으면 됨

- 각 행과 열의 교차점은 도메인에 속하는 요소의 값을 딱 한 개만 가진다.

-> 세세한 단위로 분해하지 않고 전체가 응용프로그램에서 의미가 있는 것

- 모든 열의 값은 정의된 것이어야 하고 각 행은 항상 존재한다.

-> NULL이 포함되어 있으면 관계형 모델이 무너진다. (모든 행, 모든 컬럼은 구체적인 값이 있어야 함) / 해당 부분에 자세한 내용은 뒤에서 배울 예정

### 제2 정규형

> 1NF이며 부분 함수 종속성을 갖지 않으면 그 릴레이션은 2NF가 됨

- 컬럼이 이름, 학과, 학년이 있으면 {이름} -> {학년}이라는 함수 종속이 존재
    - 같은 학생에 대해서 학년이 여러번 등록 튜플 전체를 보면 값이 중복되지 않아도 그 일부 중복이 존재하는 상태가 문제
    - 값을 갱신시 중복되는 값을 한 번에 모두 갱신하는게 아닌 일부만 갱신하는 변칙이 생기게 됨

**무손실 분해**

> 정보를 잃지 않고 테이블을 분해하는 것

- 이름, 학과
- 이름, 학년

### 제3 정규형

> 추이 함수 종속성이라는 함수 종속성을 제거하는 작업

- **추이 함수 종속성**은 키가아닌 속성 사이의 함수 종속성
- 이름, 학과, 대표번호라는 컬럼을 가진 테이블이 있으면 {학과} -> {대표번호}라는 함수 종속성이 존재
    - 2NF와 동일하게 **무손실 분해**를 수행

### 보이스코드 정규형(BCNF)

> 키가 아닌 속성에서 후보키의 진부분집합에 대한 함수 종속성

- 컬럼이 이름, 학과, 연구실이 있으면 연구실이 학과보다 더 자세한 정보. {연구실} -> {학과}라는 함수 종속성이 존재
- {이름, 연구실} 후보키 가능 / {이름, 학과} 후보키 가능
- 후보키가 되는 속성의 조합이 여러 개가 존재
    - {이름, 연구실}, {연구실, 학과}로 무손실 분해가 가능